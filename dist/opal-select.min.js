!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("cellx"),require("rionite")):"function"==typeof define&&define.amd?define(["cellx","rionite"],e):"object"==typeof exports?exports["opal-select"]=e(require("cellx"),require("rionite")):t["opal-select"]=e(t.cellx,t.rionite)}(this,function(t,e){return function(t){function e(n){if(o[n])return o[n].exports;var s=o[n]={exports:{},id:n,loaded:!1};return t[n].call(s.exports,s,s.exports,e),s.loaded=!0,s.exports}var o={};return e.m=t,e.c=o,e.p="",e(0)}([function(t,e,o){"use strict";o(26),o(27);var n=o(2),s=n.utils.nextTick,i=n.cellx,c=o(3),l=c.Component,r=c.template,p=c.components.RtRepeat,u=o(28),a=o(31),h=Array.prototype.map;t.exports=l.extend("opal-select",{Static:{OpalSelectOption:u,props:{type:String,size:"m",text:String,placeholder:"â€”",multiple:!1,focused:!1,tabIndex:0,disabled:!1},template:r(o(32)),assets:{button:{"on-focusin":function(){this.props.focused=!0,this.emit("focusin")},"on-focusout":function(){this.props.focused=!1,this.emit("focusout")},"on-click":function(){this[this.button.checked?"open":"close"]()}},menu:{"on-close":function(){this.close()},"on-change":function(t){t.target instanceof p&&(this._options.pull(),this._updateOptions())},"on-select":function(t){var e=t.target;if(e instanceof u)if(this.props.multiple){var o=this.value;1==o.push(e.value)?this.text=e.text:this.text+=", "+e.text}else this.value=e.value,this.text=e.text,this._updateOptions(),this.close(),this.focus()},"on-deselect":function(t){var e=t.target;if(e instanceof u)if(this.props.multiple){var o=this.value,n=o.indexOf(e.value);o.splice(n,1),o.length?n?this.text=n==o.length?this.text.slice(0,-(e.text.length+2)):this.text.split(", "+e.text+",").join(","):this.text=this.text.slice(e.text.length+2):this.text=this.props.placeholder}else e.select(),this.close(),this.focus()}},filteredList:{},loadedList:{}}},_opened:!1,_focused:!1,initialize:function(){i.define(this,{options:function t(e,o,n){var s=this.optionElements,t=s?h.call(s,function(t){return t.$c}):[];return n&&a(t,n)?n:t},value:void 0,text:void 0})},ready:function(){this.optionElements=this.element.getElementsByClassName("opal-select-option");var t=this.props;if(t.multiple){var e=this.options.filter(function(t){return t.selected});this.value=e.map(function(t){return t.value}),this.text=e.map(function(t){return t.text}).join(", ")||t.placeholder}else{var o=this.options.find(function(t){return t.selected});o?(this.value=o.value,this.text=o.text):(this.value=null,this.text=t.placeholder)}},elementAttached:function(){this.listenTo(this,"change:value",this._onValueChange)},elementAttributeChanged:function(t,e,o){"focused"==t&&this[o?"focus":"blur"]()},_onValueChange:function(t){this.emit({type:"change",value:t.value})},_updateOptions:function(){var t=this.value;this.options.forEach(this.props.multiple?function(e){e.selected=t&&t.indexOf(e.value)!=-1}:function(e){e.selected=e.value==t})},open:function(){var t=this;return!this._opened&&(this._opened=!0,this.button.check(),this.menu.open(),this.loadedList&&s(function(){t.loadedList.checkLoading()}),this.filteredList?this.filteredList.focus():this._focusOptions(),this._documentFocusInListening=this.listenTo(document,"focusin",this._onDocumentFocusIn),this._focused||(this._documentKeyDownListening=this.listenTo(document,"keydown",this._onDocumentKeyDown)),!0)},close:function(){return!!this._opened&&(this._opened=!1,this.button.uncheck(),this.menu.close(),this._documentFocusInListening.stop(),this._focused||this._documentKeyDownListening.stop(),!0)},toggle:function(t){return void 0!==t?t?this.open():!this.close():this.open()||!this.close()},_onDocumentFocusIn:function(t){for(var e=document.body,o=this.element,n=t.target;;){if(n==e){this.close();break}if(n=n.parentNode,n==o)break}},focus:function(){return this._focused||(this._focused=!0,this.button.focus(),this._opened||(this._documentKeyDownListening=this.listenTo(document,"keydown",this._onDocumentKeyDown))),this},blur:function(){return this._focused&&(this._focused=!1,this.button.blur(),this._opened||this._documentKeyDownListening.stop()),this},_onDocumentKeyDown:function(t){switch(t.which){case 32:t.preventDefault(),this._opened?this._focused&&this.close():this.open();break;case 38:if(t.preventDefault(),this._opened){if(document.activeElement==document.body)this._focusOptions()&&document.body.classList.remove("_no-focus-highlight");else for(var e=this.options,o=1,n=e.length;o<n;o++)if(e[o].props.focused){do{var s=e[--o];if(!s.props.disabled){document.body.classList.remove("_no-focus-highlight"),s.focus();break}}while(o);break}}else this.open();break;case 40:if(t.preventDefault(),this._opened){if(document.activeElement==document.body)this._focusOptions()&&document.body.classList.remove("_no-focus-highlight");else for(var i=this.options,c=0,l=i.length-1;c<l;c++)if(i[c].props.focused){do{var r=i[++c];if(!r.props.disabled){document.body.classList.remove("_no-focus-highlight"),r.focus();break}}while(c<l);break}}else this.open();break;case 27:t.preventDefault(),this.close(),this.focus()}},_focusOptions:function(){for(var t=this.props.multiple,e=this.options,o=void 0,n=0,s=e.length;n<s;n++){var i=e[n];if(!i.props.disabled){if(t||!i.selected){o=i;break}o||(o=i)}}return!!o&&(o.focus(),!0)}})},,function(e,o){e.exports=t},function(t,o){t.exports=e},,,,,,,,,,,,,,,,,,,,,,,function(t,e){t.exports=function(t){var e=t.head||t.getElementsByTagName("head")[0];if(e){var o=t.createElement("style");return o.type="text/css",o.textContent=".opal-select{position:relative;display:inline-block}.opal-select__icon-chevron-down{display:inline-block;margin-left:.25em;width:13px;height:13px;vertical-align:middle;transition:-webkit-transform .1s linear;transition:transform .1s linear;transition:transform .1s linear,-webkit-transform .1s linear;fill:currentColor}.opal-select__button[checked] .opal-select__icon-chevron-down{-webkit-transform:scaleY(-1);-ms-transform:scaleY(-1);transform:scaleY(-1)}.opal-select .opal-popover{min-width:200px}.opal-select .opal-filtered-list__tf-query-wrapper{margin:10px}.opal-select .opal-loaded-list{height:360px}",e.appendChild(o),o}return null}(document)},function(t,e){!function o(){document.body?document.body.insertAdjacentHTML("beforeend",'<svg xmlns="http://www.w3.org/2000/svg" style="display:none"><symbol viewBox="0 0 24 13" id="opal-select__icon-chevron-down"><path d="M11.5 12.6c-.3 0-.5-.1-.7-.3L.3 1.9C-.1 1.5-.1.8.3.3c.4-.4 1.1-.4 1.6 0l9.7 9.7L21.3.3c.4-.4 1.1-.4 1.6 0 .4.4.4 1.1 0 1.6L12.3 12.3c-.2.2-.5.3-.8.3z"/></symbol></svg>'):setTimeout(o,100)}()},function(t,e,o){"use strict";o(29);var n=o(2),s=o(3),i=s.Component;t.exports=i.extend("opal-select-option",{Static:{props:{value:String,text:String,selected:!1,focused:!1,tabIndex:0,disabled:!1},template:o(30),assets:{control:{"on-focusin":function(){this.props.focused=!0},"on-focusout":function(){this.props.focused=!1},"on-click":function(){this._click()}}}},_focused:!1,initialize:function(){var t=this.props,e=t.text;if(void 0===e)throw new TypeError('"text" property is required');n.define(this,{_tabIndex:function(){return t.disabled?-1:t.tabIndex}})},ready:function(){void 0===this.props.value&&(this.props.value=this.props.text)},elementAttributeChanged:function(t,e,o){"focused"==t&&this[o?"focus":"blur"]()},_onDocumentKeyDown:function(t){13!=t.which&&32!=t.which||(t.preventDefault(),this.props.disabled||this._click())},_click:function(){this.emit(this.toggle()?"select":"deselect")},get value(){var t=this.props;return void 0===t.value?t.text:t.value},set value(t){this.props.value=t},get text(){return this.props.text.trim().replace(","," ")||" "},set text(t){this.props.text=t},get selected(){return this.props.selected},set selected(t){this.props.selected=t},select:function(){return!this.props.selected&&(this.props.selected=!0,!0)},deselect:function(){return!!this.props.selected&&(this.props.selected=!1,!0)},toggle:function(t){return void 0!==t?this.props.selected=!!t:this.props.selected=!this.props.selected},focus:function(){return this._focused||(this._focused=!0,this.control.focus(),this._documentKeyDownListening=this.listenTo(document,"keydown",this._onDocumentKeyDown)),this},blur:function(){return this._focused&&(this._focused=!1,this.control.blur(),this._documentKeyDownListening.stop()),this},enable:function(){return this.props.disabled=!1,this},disable:function(){return this.props.disabled=!0,this}})},function(t,e){t.exports=function(t){var e=t.head||t.getElementsByTagName("head")[0];if(e){var o=t.createElement("style");return o.type="text/css",o.textContent=".opal-select-option{display:block}.opal-select-option__control{position:relative;display:block;padding:7px 22px;background:#fff;color:#000;text-align:left;text-shadow:none;white-space:nowrap;font:16px/24px Verdana,Geneva,sans-serif;font-weight:400;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;-webkit-text-size-adjust:100%;-ms-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}.opal-select-option__content{position:relative;display:block}.opal-select-option__control:hover{background:#e6e6e6}.opal-select-option__control:focus{outline:none}.opal-select-option__control:focus::after{position:absolute;top:2px;right:2px;bottom:2px;left:2px;box-shadow:inset 0 0 0 1px #33a0ff;content:'';pointer-events:none}.opal-select-option__control:active{background:#ccc}.opal-select-option[selected] .opal-select-option__control{color:#0d87f2}.opal-select-option[disabled]{opacity:.5;pointer-events:none}.opal-select-option[disabled] .opal-select-option__control{cursor:default}",e.appendChild(o),o}return null}(document)},function(t,e){t.exports='<span class="opal-select-option__control" tabindex="{_tabIndex}"> <rt-content class="opal-select-option__content">{props.text}</rt-content> </span>'},function(t,e){"use strict";function o(t,e){var o=t.length,n=e.length;if(o!=n)return!1;for(var s=0;s<o;s++)if(t[s]!==e[s])return!1;return!0}t.exports=o},function(t,e){t.exports='<rt-content select=".opal-select__button"> <opal-button class="opal-select__button" type="{props.type}" size="{props.size}" checkable="" tab-index="{props.tabIndex}" disabled="{props.disabled}"> <template is="rt-if-then" if="props.text">{props.text}</template> <template is="rt-if-else" if="props.text">{text}</template> {{block icon_chevron_down }} <svg viewBox="0 0 24 13" class="opal-select__icon-chevron-down"><use xlink:href="#opal-select__icon-chevron-down"></use></svg> {{/block}} </opal-button> </rt-content> <rt-content select=".opal-select__menu"> <opal-dropdown class="opal-select__menu" auto-closing=""> <rt-content select=".opal-select__menu-inner"> <span class="opal-select__menu-inner"> {{block options }} <rt-content select="opal-select-option"></rt-content> {{/block}} </span> </rt-content> </opal-dropdown> </rt-content>'}])});
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("rionite"),require("cellx")):"function"==typeof define&&define.amd?define(["rionite","cellx"],t):"object"==typeof exports?exports["opal-tag-select"]=t(require("rionite"),require("cellx")):e["opal-tag-select"]=t(e.rionite,e.cellx)}(this,function(e,t){return function(e){function t(o){if(a[o])return a[o].exports;var l=a[o]={exports:{},id:o,loaded:!1};return e[o].call(l.exports,l,l.exports,t),l.loaded=!0,l.exports}var a={};return t.m=e,t.c=a,t.p="",t(0)}({0:function(e,t,a){"use strict";a(76);var o=a(2),l=a(1),i=l.getText,s=l.ComponentTemplate,n=l.Component;e.exports=n.extend("opal-tag-select",{Static:{props:{type:String,datalist:{type:String,readonly:!0},dataprovider:{type:String,readonly:!0},value:Object,viewModel:{type:String,readonly:!0},viewModelItemSchema:{default:{value:"value",text:"text",disabled:"disabled"},readonly:!0},placeholder:i.t("Не выбрано"),allowInput:!1,popoverTo:"bottom",disabled:!1},template:new s(a(43)),events:{control:{click:function(e,t){for(var a=this.$("select"),o=a.element,l=e.target;l!=o;l=l.parentNode)if(l==t){a.toggle();break}}},select:{confirminput:function(){var e=this.$("select");e.props.allowInput&&e.close()},select:function(){this.$("select").close()},deselect:function(){this.$("select").close()}}}},initialize:function(){var e=this.props,t=e.datalist,a=e.dataprovider,l=e.viewModel;this._dataListParam=t&&"dataList",this._dataProviderParam=a&&"dataProvider",this._viewModelParam=l&&"viewModel";var i=void 0;t&&(i=Function("return this."+t+";"));var s=this.ownerComponent||window;o.define(this,{dataList:t&&function(){return i.call(s)},dataProvider:a&&Function("return this."+a+";").call(s),viewModel:l&&Function("return this."+l+";").call(s),placeholderShown:function(){return!(!this.props.placeholder||this.viewModel&&this.viewModel.length)}});var n=e.viewModelItemSchema;this._viewModelItemValueFieldName=n.value,this._viewModelItemTextFieldName=n.text,this._viewModelItemDisabledFieldName=n.disabled},ready:function(){this.dataList=this.$("select").dataList,this.viewModel=this.$("select").viewModel},_onBtnRemoveTagClick:function(e,t){this.viewModel.remove(this.viewModel.get(t.dataset.tagValue,this._viewModelItemValueFieldName)),this.emit("change")}})},1:function(t,a){t.exports=e},2:function(e,a){e.exports=t},43:function(e,t){e.exports='<span class="opal-tag-select__tags"> <template is="rt-if-then" if="viewModel?.length" rt-silent=""> <template is="rt-repeat" for="tag of viewModel" rt-silent=""> <span class="opal-tag-select__tag" data-value="{tag |key(_viewModelItemValueFieldName) }" disabled="{tag |key(_viewModelItemDisabledFieldName) }">{ tag |key(_viewModelItemTextFieldName) }<button class="opal-tag-select__btn-remove-tag" data-tag-value="{tag |key(_viewModelItemValueFieldName) }" rt-click="_onBtnRemoveTagClick"></button></span> </template> </template> </span> <span class="opal-tag-select__control"> <template is="rt-if-then" if="placeholderShown" rt-silent=""> <span class="opal-tag-select__placeholder">{props.placeholder}</span> </template> {{block select }} <opal-select class="opal-tag-select__select" datalist="{_dataListParam}" value="{props.value}" view-model="{_viewModelParam}" view-model-item-schema="{props.viewModelItemSchema |json }" multiple="" allow-input="{props.allowInput}"> {{block select_button }} <opal-sign-button class="opal-tag-select__select-button opal-select__button" sign="plus" checkable=""></opal-sign-button> {{/block}} {{block select_menu }} <opal-popover class="opal-select__menu" to="{props.popoverTo}" auto-closing=""> <rt-content select=".opal-tag-select__menu-content"> <template is="rt-if-then" if="props.datalist"> <div class="opal-select__menu-content"> <template is="rt-if-then" if="dataList?.length"> <template is="rt-repeat" for="item of dataList"> {{block select_option }} <opal-select-option value="{item.value}" text="{item.text}"></opal-select-option> {{/block}} </template> {{block select_new }} <rt-content class="opal-select__new-input-container" select=".opal-select__new-input">{{block new_input }}{{/block}}</rt-content> {{/block}} </template> <template is="rt-if-else" if="dataList?.length" rt-silent=""> {{block select_loader }} <opal-loader shown=""></opal-loader> {{/block}} </template> </div> </template> <template is="rt-if-else" if="props.datalist"> <opal-filtered-list class="opal-tag-select__menu-content opal-select__filtered-list"> <opal-loaded-list class="opal-select__loaded-list opal-filtered-list__loaded-list" dataprovider="{_dataProviderParam}"> <opal-select-option value="{$item.value}" text="{$item.text}"></opal-select-option> </opal-loaded-list> </opal-filtered-list> </template> </rt-content> </opal-popover> {{/block}} </opal-select> {{/block}} </span>'},76:function(e,t){e.exports=function(e){var t=e.head||e.getElementsByTagName("head")[0];if(t){var a=e.createElement("style");return a.type="text/css",a.textContent=".opal-tag-select{display:inline-block}.opal-tag-select .opal-tag-select__tag{position:relative;top:-1px;display:inline-block;margin:2px 35px 2px 0;padding:0 10px 0 16px;border-top-left-radius:16px;border-bottom-left-radius:16px;background:#5b7d9a;color:#fff;vertical-align:middle;text-decoration:none;text-shadow:none;font:16px/32px Verdana,Geneva,sans-serif;font-weight:400}.opal-tag-select .opal-tag-select__btn-remove-tag{position:absolute;top:0;bottom:0;left:100%;display:block;padding:0;width:32px;border:0;border-top-right-radius:16px;border-bottom-right-radius:16px;background:#516270;box-shadow:inset 1px 0 rgba(0,0,0,.4);cursor:pointer;transition:background .1s}.opal-tag-select .opal-tag-select__btn-remove-tag::before{position:absolute;top:0;right:0;bottom:0;left:0;margin:auto;width:12px;height:2px;background:#fff;content:''}.opal-tag-select .opal-tag-select__btn-remove-tag:hover{background:#5b7d9a}.opal-tag-select .opal-tag-select__btn-remove-tag:focus{outline:none}body:not(._no-focus-highlight) .opal-tag-select .opal-tag-select__btn-remove-tag:focus::after{position:absolute;top:2px;right:2px;bottom:2px;left:2px;border:1px solid rgba(255,255,255,.8);border-radius:inherit;content:'';pointer-events:none}.opal-tag-select .opal-tag-select__btn-remove-tag:active{background:#43484c}.opal-tag-select .opal-tag-select__tag[disabled]{margin-right:3px;padding-right:16px;border-top-right-radius:16px;border-bottom-right-radius:16px}.opal-tag-select .opal-tag-select__tag[disabled] .opal-tag-select__btn-remove-tag{display:none}.opal-tag-select .opal-tag-select__control{display:inline-block;white-space:nowrap;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.opal-tag-select[type=action] .opal-tag-select__tag{background:#0083f5}.opal-tag-select[type=action] .opal-tag-select__btn-remove-tag{background:#0a67b8}.opal-tag-select[type=action] .opal-tag-select__btn-remove-tag:hover{background:#0083f5}.opal-tag-select[type=action] .opal-tag-select__btn-remove-tag:active{background:#0e4b81}.opal-tag-select[type=danger] .opal-tag-select__tag{background:#fa0f3e}.opal-tag-select[type=danger] .opal-tag-select__btn-remove-tag{background:#c70f34}.opal-tag-select[type=danger] .opal-tag-select__btn-remove-tag:hover{background:#fa0f3e}.opal-tag-select[type=danger] .opal-tag-select__btn-remove-tag:active{background:#90142c}",t.appendChild(a),a}return null}(document)}})});
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("rionite"),require("cellx"),require("cellx-indexed-collections")):"function"==typeof define&&define.amd?define(["rionite","cellx","cellx-indexed-collections"],t):"object"==typeof exports?exports["opal-tag-select"]=t(require("rionite"),require("cellx"),require("cellx-indexed-collections")):e["opal-tag-select"]=t(e.rionite,e.cellx,e["cellx-indexed-collections"])}(this,function(e,t,a){return function(e){function t(o){if(a[o])return a[o].exports;var l=a[o]={exports:{},id:o,loaded:!1};return e[o].call(l.exports,l,l.exports,t),l.loaded=!0,l.exports}var a={};return t.m=e,t.c=a,t.p="",t(0)}({0:function(e,t,a){"use strict";var o=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])};return function(t,a){function o(){this.constructor=t}e(t,a),t.prototype=null===a?Object.create(a):(o.prototype=a.prototype,new o)}}(),l=this&&this.__decorate||function(e,t,a,o){var l,n=arguments.length,i=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,a):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,a,o);else for(var r=e.length-1;r>=0;r--)(l=e[r])&&(i=(n<3?l(i):n>3?l(t,a,i):l(t,a))||i);return n>3&&i&&Object.defineProperty(t,a,i),i};Object.defineProperty(t,"__esModule",{value:!0}),a(75);var n=a(2),i=a(3),r=a(1),s=a(42),d={value:"value",text:"text",disabled:"disabled"},p={value:"value",text:"text",disabled:"disabled"},c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.initialize=function(){var e=this.props;if(e.datalistKeypath){var t=this.ownerComponent||window,a=Function("return this."+e.datalistKeypath+";");n.define(this,"dataList",function(){return a.call(t)});var o=e.datalistItemSchema;this._dataListItemValueFieldName=o.value||d.value,this._dataListItemTextFieldName=o.text||d.text,this._dataListItemDisabledFieldName=o.disabled||d.disabled,this.dataProvider=null,this._dataListKeypathParam="dataList"}else{this.dataList=null;var l=e.dataprovider;if(!l&&e.dataproviderKeypath&&!(l=Function("return this."+e.dataproviderKeypath+";").call(this.ownerComponent||window)))throw new TypeError("dataProvider is not defined");this.dataProvider=l,this._dataListKeypathParam=null}var r=e.viewModelItemSchema;this._viewModelItemValueFieldName=r.value||p.value,this._viewModelItemTextFieldName=r.text||p.text,this._viewModelItemDisabledFieldName=r.disabled||p.disabled;var s;if(e.viewModelKeypath){if(!(s=Function("return this."+e.viewModelKeypath+";").call(this.ownerComponent||window)))throw new TypeError("viewModel is not defined")}else s=new i.IndexedList(void 0,{indexes:[this._viewModelItemValueFieldName]});n.define(this,{viewModel:s,placeholderShown:function(){return!!this.props.placeholder&&!this.viewModel.length}})},t.prototype._onBtnRemoveTagClick=function(e,t){this.viewModel.remove(this.viewModel.get(t.dataset.tagValue,this._viewModelItemValueFieldName)),this.emit("change")},t}(r.Component);c=l([r.d.Component({elementIs:"opal-tag-select",props:{viewType:String,datalistKeypath:{type:String,readonly:!0},datalistItemSchema:{type:eval,default:d,readonly:!0},dataprovider:{type:Object,readonly:!0},dataproviderKeypath:{type:String,readonly:!0},value:eval,viewModelKeypath:{type:String,readonly:!0},viewModelItemSchema:{type:eval,default:p,readonly:!0},placeholder:r.getText.t("Не выбрано"),popoverTo:"bottom",disabled:!1},template:s,events:{control:{click:function(e){var t=this.$("select"),a=t.element,o=e.target;if(o!=a){var l=this.$("control");do{if(o==l){t.toggle();break}o=o.parentNode}while(o!=a)}}},select:{input:function(){this.$("select").close()},"<opal-select-option>select":function(){this.$("select").close()},"<opal-select-option>deselect":function(){this.$("select").close()}}}})],c),t.default=c},1:function(t,a){t.exports=e},2:function(e,a){e.exports=t},3:function(e,t){e.exports=a},42:function(e,t){e.exports="@section/inner {\nspan/tags {\n@if-then (if=viewModel.length, rt-silent) {\n@repeat (for=tag of viewModel, track-by={_viewModelItemValueFieldName}, rt-silent) {\nspan/tag (\ndata-value='{tag |key(_viewModelItemValueFieldName) }',\ndisabled='{tag |key(_viewModelItemDisabledFieldName) }'\n) {\n'{tag |key(_viewModelItemTextFieldName) }'\nbutton/btn-remove-tag (\ndata-tag-value='{tag |key(_viewModelItemValueFieldName) }',\nrt-click=_onBtnRemoveTagClick\n)\n}\n' '\n}\n}\n}\nspan/control {\n@if-then (if=placeholderShown, rt-silent) {\nspan/placeholder { '{props.placeholder} ' }\n}\nopal-select/select (\nmultiple,\ndatalist-keypath={_dataListKeypathParam},\ndatalist-item-schema={props.datalistItemSchema |json },\nvalue={props.value},\nview-model-keypath=viewModel,\nview-model-item-schema={props.viewModelItemSchema |json }\n) {\nopal-sign-button/button (class=opal-select__button, sign=plus, checkable)\nopal-popover/menu (class=opal-select__menu, to={props.popoverTo}, auto-closing) {\nrt-content (select='.opal-select__menu-content', cloning=no) {\n@if-then (if=props.datalistKeypath) {\ndiv (class=opal-select__menu-content) {\n@if-then (if=dataList.length) {\n@repeat (for=item of dataList) {\nopal-select-option/select-option-of-datalist, select-option (\nvalue='{item |key(_dataListItemValueFieldName) }',\ntext='{item |key(_dataListItemTextFieldName) }',\ndisabled='{item |key(_dataListItemDisabledFieldName) }'\n)\n}\nrt-content (\nclass=opal-select__new-item-input-container,\nselect='.opal-select__new-item-input'\n)\n}\n@if-else (if=dataList.length, rt-silent) {\nopal-loader/menu-loader (shown)\n}\n}\n}\n@if-else (if=props.datalistKeypath) {\nopal-filtered-list/menu-filtered-list (class=opal-select__menu-content opal-select__filtered-list) {\nrt-content (\nclass=opal-filtered-list__query-input-container,\nselect=.opal-filtered-list__query-input,\ncloning=no\n)\nopal-loaded-list/menu-loaded-list (\nclass=opal-select__loaded-list opal-filtered-list__loaded-list,\ndataprovider-keypath=dataProvider\n) {\nopal-select-option/select-option-of-loaded-list, select-option (\nvalue={$item.value},\ntext={$item.text}\n)\n}\n}\n}\n}\n}\n}\n}\n}"},75:function(e,t){e.exports=function(e){var t=e.head||e.getElementsByTagName("head")[0];if(t){var a=e.createElement("style");return a.type="text/css",a.textContent=".opal-tag-select{display:inline-block}.opal-tag-select .opal-tag-select__tag{position:relative;top:-1px;display:inline-block;margin:2px 35px 2px 0;padding:0 10px 0 16px;border-top-left-radius:16px;border-bottom-left-radius:16px;background:#5b7d9a;color:#fff;vertical-align:middle;text-decoration:none;text-shadow:none;font:16px/32px Verdana,Geneva,sans-serif;font-weight:400}.opal-tag-select .opal-tag-select__btn-remove-tag{position:absolute;top:0;bottom:0;left:100%;display:block;padding:0;width:32px;border:0;border-top-right-radius:16px;border-bottom-right-radius:16px;background:#516270;box-shadow:inset 1px 0 rgba(0,0,0,.4);cursor:pointer;transition:background .1s linear}.opal-tag-select .opal-tag-select__btn-remove-tag::before{position:absolute;top:0;right:0;bottom:0;left:0;margin:auto;width:12px;height:2px;background:#fff;content:''}.opal-tag-select .opal-tag-select__btn-remove-tag:hover{background:#5b7d9a}.opal-tag-select .opal-tag-select__btn-remove-tag:focus{outline:none}body:not(._no-focus-highlight) .opal-tag-select .opal-tag-select__btn-remove-tag:focus::after{position:absolute;top:2px;right:2px;bottom:2px;left:2px;border:1px solid rgba(255,255,255,.8);border-radius:inherit;content:'';pointer-events:none}.opal-tag-select .opal-tag-select__btn-remove-tag:active{background:#43484c}.opal-tag-select .opal-tag-select__tag[disabled]{margin-right:3px;padding-right:16px;border-top-right-radius:16px;border-bottom-right-radius:16px}.opal-tag-select .opal-tag-select__tag[disabled] .opal-tag-select__btn-remove-tag{display:none}.opal-tag-select .opal-tag-select__control{display:inline-block;white-space:nowrap;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.opal-tag-select[view-type=primary] .opal-tag-select__tag{background:#0083f5}.opal-tag-select[view-type=primary] .opal-tag-select__btn-remove-tag{background:#0a67b8}.opal-tag-select[view-type=primary] .opal-tag-select__btn-remove-tag:hover{background:#0083f5}.opal-tag-select[view-type=primary] .opal-tag-select__btn-remove-tag:active{background:#0e4b81}.opal-tag-select[view-type=danger] .opal-tag-select__tag{background:#fa0f3e}.opal-tag-select[view-type=danger] .opal-tag-select__btn-remove-tag{background:#c70f34}.opal-tag-select[view-type=danger] .opal-tag-select__btn-remove-tag:hover{background:#fa0f3e}.opal-tag-select[view-type=danger] .opal-tag-select__btn-remove-tag:active{background:#90142c}",t.appendChild(a),a}return null}(document)}})});
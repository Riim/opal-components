<span class="opal-tag-select__tags">
	<template is="rt-if-then" if="viewModel.length" rt-silent>
		<template is="rt-repeat" for="tag of viewModel" track-by="{_viewModelItemValueFieldName}" rt-silent>
			<span class="opal-tag-select__tag" data-value="{tag |key(_viewModelItemValueFieldName) }"
					disabled="{tag |key(_viewModelItemDisabledFieldName) }">{
					tag |key(_viewModelItemTextFieldName) }<button
							class="opal-tag-select__btn-remove-tag"
							data-tag-value="{tag |key(_viewModelItemValueFieldName) }"
							rt-click="_onBtnRemoveTagClick"></button></span>
		</template>
	</template>
</span>

<span class="opal-tag-select__control">
	<template is="rt-if-then" if="placeholderShown" rt-silent>
		<span class="opal-tag-select__placeholder">{props.placeholder}</span>
	</template>

	{{block select }}
		<opal-select class="opal-tag-select__select" datalist="{_dataListParam}" value="{props.value}"
				view-model="{_viewModelParam}" view-model-item-schema="{props.viewModelItemSchema |json }" multiple
				allow-input="{props.allowInput}">
			{{block select_button }}
				<opal-sign-button class="opal-tag-select__select-button opal-select__button" sign="plus"
						checkable></opal-sign-button>
			{{/block}}

			{{block select_menu }}
				<opal-popover class="opal-select__menu" to="{props.popoverTo}" auto-closing>
					<rt-content select=".opal-tag-select__menu-content" no-clone>
						<template is="rt-if-then" if="props.datalist">
							<div class="opal-select__menu-content">
								<template is="rt-if-then" if="dataList.length">
									<template is="rt-repeat" for="item of dataList">
										{{block select_option }}
											<opal-select-option value="{item.value}"
													text="{item.text}"></opal-select-option>
										{{/block}}
									</template>
									{{block select_new }}
										<rt-content class="opal-select__new-input-container"
												select=".opal-select__new-input
												">{{block new_input }}{{/block}}</rt-content>
									{{/block}}
								</template>
								<template is="rt-if-else" if="dataList.length" rt-silent>
									{{block select_loader }}
										<opal-loader shown></opal-loader>
									{{/block}}
								</template>
							</div>
						</template>
						<template is="rt-if-else" if="props.datalist">
							<opal-filtered-list class="opal-tag-select__menu-content opal-select__filtered-list">
								<opal-loaded-list class="opal-select__loaded-list opal-filtered-list__loaded-list"
										dataprovider="{_dataProviderParam}">
									<opal-select-option value="{$item.value}" text="{$item.text}"></opal-select-option>
								</opal-loaded-list>
							</opal-filtered-list>
						</template>
					</rt-content>
				</opal-popover>
			{{/block}}
		</opal-select>
	{{/block}}
</span>